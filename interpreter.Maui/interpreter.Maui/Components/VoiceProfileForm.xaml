<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="interpreter.Maui.Components.VoiceProfileForm">
    
    <ContentView.Resources>
        <!-- Match MainPage theme -->
        <Color x:Key="ColorSurface">#0B1220</Color>
        <Color x:Key="ColorSurfaceHigh">#111827</Color>
        <Color x:Key="ColorTextPrimary">#F9FAFB</Color>
        <Color x:Key="ColorTextSecondary">#9CA3AF</Color>
        <Color x:Key="ColorAccentPrimary">#22C7B8</Color>
        <Color x:Key="ColorAccentSecondary">#818CF8</Color>
        <Color x:Key="ColorDanger">#F97373</Color>
        <Color x:Key="ColorWarning">#FACC15</Color>

        <SolidColorBrush x:Key="BrushSurface" Color="{StaticResource ColorSurface}" />
        <SolidColorBrush x:Key="BrushSurfaceHigh" Color="{StaticResource ColorSurfaceHigh}" />
        <SolidColorBrush x:Key="BrushTextPrimary" Color="{StaticResource ColorTextPrimary}" />
        <SolidColorBrush x:Key="BrushTextSecondary" Color="{StaticResource ColorTextSecondary}" />
        <SolidColorBrush x:Key="BrushAccentPrimary" Color="{StaticResource ColorAccentPrimary}" />
        <SolidColorBrush x:Key="BrushAccentSecondary" Color="{StaticResource ColorAccentSecondary}" />
        <SolidColorBrush x:Key="BrushDanger" Color="{StaticResource ColorDanger}" />
        <SolidColorBrush x:Key="BrushWarning" Color="{StaticResource ColorWarning}" />
    </ContentView.Resources>
    
    <!-- Outer card -->
    <Border Background="{StaticResource BrushSurfaceHigh}"
            StrokeThickness="1"
            Stroke="{StaticResource BrushAccentSecondary}"
            Padding="18">
        <Border.StrokeShape>
            <RoundRectangle CornerRadius="18"/>
        </Border.StrokeShape>
        <Border.Shadow>
            <Shadow Brush="#33000000" Offset="0,8" Radius="18" Opacity="0.3" />
        </Border.Shadow>
        
        <VerticalStackLayout Spacing="16">

            <!-- Name Entry -->
            <VerticalStackLayout Spacing="6">
                <Label Text="Profile Name"
                       TextColor="{StaticResource ColorTextPrimary}"
                       FontSize="13"
                       FontAttributes="Bold"/>
                
                <Border x:Name="NameEntryBorder"
                        Background="{StaticResource BrushSurface}"
                        StrokeThickness="1"
                        Stroke="{StaticResource BrushAccentSecondary}"
                        Padding="10,6">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12"/>
                    </Border.StrokeShape>
                    <Entry x:Name="NameEntry"
                           Placeholder="e.g. Meeting Room Mic, John, Studio Mic"
                           PlaceholderColor="#6B7280"
                           TextColor="{StaticResource ColorTextPrimary}"
                           BackgroundColor="Transparent"
                           FontSize="13"
                           TextChanged="OnNameTextChanged"/>
                </Border>
                
                <Label x:Name="NameHelperLabel"
                       Text="Give this profile a clear, memorable name."
                       TextColor="{StaticResource ColorTextSecondary}"
                       FontSize="11"/>
            </VerticalStackLayout>
            
            <!-- Duration Selector -->
            <VerticalStackLayout Spacing="6">
                <Label Text="Recording Duration"
                       TextColor="{StaticResource ColorTextPrimary}"
                       FontSize="13"
                       FontAttributes="Bold"/>
                <Picker x:Name="DurationPicker"
                        Title="Select duration"
                        TextColor="{StaticResource ColorTextPrimary}"
                        BackgroundColor="{StaticResource ColorSurface}"
                        SelectedIndexChanged="OnDurationChanged">
                    <Picker.ItemsSource>
                        <x:Array Type="{x:Type x:String}">
                            <x:String>30 seconds</x:String>
                            <x:String>60 seconds</x:String>
                        </x:Array>
                    </Picker.ItemsSource>
                </Picker>
            </VerticalStackLayout>
            
            <!-- Voice Recording Section -->
            <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*" ColumnSpacing="14" RowSpacing="8">
                <!-- Record button column -->
                <VerticalStackLayout Grid.RowSpan="2" Grid.Column="0" Spacing="6" HorizontalOptions="Center">
                    <Border x:Name="RecordButton"
                            Background="{StaticResource BrushDanger}"
                            StrokeThickness="0"
                            HeightRequest="70"
                            WidthRequest="70"
                            HorizontalOptions="Center">
                        <Border.StrokeShape>
                            <Ellipse/>
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnRecordClicked"/>
                        </Border.GestureRecognizers>
                        <Label x:Name="RecordIcon"
                               Text="🎙️"
                               FontSize="30"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>
                    </Border>
                    <Label x:Name="RecordButtonLabel"
                           Text="Record"
                           TextColor="{StaticResource ColorTextSecondary}"
                           FontSize="11"
                           HorizontalOptions="Center"/>
                </VerticalStackLayout>

                <!-- Recording text / progress -->
                <VerticalStackLayout Grid.Row="0" Grid.Column="1" Spacing="4" VerticalOptions="Center">
                    <Label Text="Voice Sample"
                           TextColor="{StaticResource ColorTextPrimary}"
                           FontSize="13"
                           FontAttributes="Bold"/>
                    <Label x:Name="RecordingStatusLabel"
                           Text="Tap the mic to start recording."
                           TextColor="{StaticResource ColorTextSecondary}"
                           FontSize="11"/>
                    <Label x:Name="RecordingCountdownLabel"
                           Text=""
                           TextColor="{StaticResource ColorAccentPrimary}"
                           FontSize="13"
                           FontAttributes="Bold"/>
                </VerticalStackLayout>

                <!-- Progress / hint row -->
                <Grid Grid.Row="1" Grid.Column="1" ColumnDefinitions="*,Auto" VerticalOptions="Center">
                    <ProgressBar x:Name="RecordingProgressBar"
                                 Grid.Column="0"
                                 Progress="0"
                                 HeightRequest="4"
                                 BackgroundColor="#111827"
                                 ProgressColor="{StaticResource ColorAccentPrimary}"/>
                    <StackLayout Grid.Column="1" Orientation="Horizontal" Spacing="8">
                        <Label x:Name="RecordingLengthLabel"
                               Text="0s"
                               TextColor="{StaticResource ColorTextSecondary}"
                               FontSize="10"/>
                        <Label x:Name="RecordingTimerLabel"
                               Text=""
                               TextColor="{StaticResource ColorDanger}"
                               FontSize="10"
                               FontAttributes="Bold"/>
                    </StackLayout>
                </Grid>
            </Grid>
            
            <!-- Actions row -->
            <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10" Margin="0,4,0,0">
                <Label x:Name="FormMessageLabel"
                       Grid.Column="0"
                       Text=""
                       TextColor="{StaticResource ColorWarning}"
                       FontSize="11"
                       LineBreakMode="TailTruncation"/>
                
                <Border x:Name="SaveButton"
                        Grid.Column="1"
                        Background="{StaticResource ColorAccentSecondary}"
                        StrokeThickness="0"
                        Padding="16,10">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12"/>
                    </Border.StrokeShape>
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnSaveClicked"/>
                    </Border.GestureRecognizers>
                    <HorizontalStackLayout Spacing="6">
                        <Label Text="Save"
                               TextColor="{StaticResource ColorTextPrimary}"
                               FontSize="13"
                               FontAttributes="Bold"/>
                    </HorizontalStackLayout>
                </Border>
            </Grid>
        </VerticalStackLayout>
    </Border>
    
</ContentView>
